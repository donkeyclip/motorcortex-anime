!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("@donkeyclip/motorcortex")):"function"==typeof define&&define.amd?define(["@donkeyclip/motorcortex"],e):(t="undefined"!=typeof globalThis?globalThis:t||self)["@donkeyclip/motorcortex-anime"]=e(t.MotorCortex)}(this,(function(t){"use strict";var e={},r={duration:1e3,round:0},n=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective"],a={CSS:{}};function o(t,e,r){return Math.min(Math.max(t,e),r)}function i(t,e){return t.indexOf(e)>-1}var u={arr:function(t){return Array.isArray(t)},obj:function(t){return i(Object.prototype.toString.call(t),"Object")},pth:function(t){return u.obj(t)&&t.hasOwnProperty("totalLength")},svg:function(t){return t instanceof SVGElement},inp:function(t){return t instanceof HTMLInputElement},dom:function(t){return t.nodeType||u.svg(t)},str:function(t){return"string"==typeof t},fnc:function(t){return"function"==typeof t},und:function(t){return void 0===t},hex:function(t){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(t)},rgb:function(t){return/^rgb/.test(t)},hsl:function(t){return/^hsl/.test(t)},col:function(t){return u.hex(t)||u.rgb(t)||u.hsl(t)},key:function(t){return!e.hasOwnProperty(t)&&!r.hasOwnProperty(t)&&"targets"!==t&&"keyframes"!==t}},s={linear:function(){return function(t){return t}}};function c(t,e){for(var r=t.length,n=arguments.length>=2?arguments[1]:void 0,a=[],o=0;o<r;o++)if(o in t){var i=t[o];e.call(n,i,o,t)&&a.push(i)}return a}function f(t){return t.reduce((function(t,e){return t.concat(u.arr(e)?f(e):e)}),[])}function l(t){return u.arr(t)?t:(u.str(t)&&(t=function(t){try{return document.querySelectorAll(t)}catch(t){return}}(t)||t),t instanceof NodeList||t instanceof HTMLCollection?[].slice.call(t):[t])}function d(t,e){return t.some((function(t){return t===e}))}function h(t){var e={};for(var r in t)e[r]=t[r];return e}function p(t,e){var r=h(t);for(var n in t)r[n]=e.hasOwnProperty(n)?e[n]:t[n];return r}function g(t,e){var r=h(t);for(var n in e)r[n]=u.und(t[n])?e[n]:t[n];return r}function m(t){return u.rgb(t)?(r=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g.exec(e=t))?"rgba("+r[1]+",1)":e:u.hex(t)?function(t){var e=t.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(t,e,r,n){return e+e+r+r+n+n})),r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return"rgba("+parseInt(r[1],16)+","+parseInt(r[2],16)+","+parseInt(r[3],16)+",1)"}(t):u.hsl(t)?function(t){var e,r,n,a=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(t)||/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g.exec(t),o=parseInt(a[1],10)/360,i=parseInt(a[2],10)/100,u=parseInt(a[3],10)/100,s=a[4]||1;function c(t,e,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+6*(e-t)*r:r<.5?e:r<2/3?t+(e-t)*(2/3-r)*6:t}if(0==i)e=r=n=u;else{var f=u<.5?u*(1+i):u+i-u*i,l=2*u-f;e=c(l,f,o+1/3),r=c(l,f,o),n=c(l,f,o-1/3)}return"rgba("+255*e+","+255*r+","+255*n+","+s+")"}(t):void 0;var e,r}function v(t){var e=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/.exec(t);if(e)return e[1]}function y(t,e){return u.fnc(t)?t(e.target,e.id,e.total):t}function x(t,e){return t.getAttribute(e)}function b(t,e,r){if(d([r,"deg","rad","turn"],v(e)))return e;var n=a.CSS[e+r];if(!u.und(n))return n;var o=document.createElement(t.tagName),i=t.parentNode&&t.parentNode!==document?t.parentNode:document.body;i.appendChild(o),o.style.position="absolute",o.style.width=100+r;var s=100/o.offsetWidth;i.removeChild(o);var c=s*parseFloat(e);return a.CSS[e+r]=c,c}function w(t,e,r){if(e in t.style){var n=e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),a=t.style[e]||getComputedStyle(t).getPropertyValue(n)||"0";return r?b(t,a,r):a}}function P(t,e){return u.dom(t)&&!u.inp(t)&&(x(t,e)||u.svg(t)&&t[e])?"attribute":u.dom(t)&&d(n,e)?"transform":u.dom(t)&&"transform"!==e&&w(t,e)?"css":null!=t[e]?"object":void 0}function C(t){if(u.dom(t)){for(var e,r=t.style.transform||"",n=/(\w+)\(([^)]*)\)/g,a=new Map;e=n.exec(r);)a.set(e[1],e[2]);return a}}function k(t,e,r,n){var a=i(e,"scale")?1:0+function(t){return i(t,"translate")||"perspective"===t?"px":i(t,"rotate")||i(t,"skew")?"deg":void 0}(e),o=C(t).get(e)||a;return r&&(r.transforms.list.set(e,o),r.transforms.last=e),n?b(t,o,n):o}function M(t,e,r,n){switch(P(t,e)){case"transform":return k(t,e,n,r);case"css":return w(t,e,r);case"attribute":return x(t,e);default:return t[e]||0}}function S(t,e){var r=/^(\*=|\+=|-=)/.exec(t);if(!r)return t;var n=v(t)||0,a=parseFloat(e),o=parseFloat(t.replace(r[0],""));switch(r[0][0]){case"+":return a+o+n;case"-":return a-o+n;case"*":return a*o+n}}function A(t,e){if(u.col(t))return m(t);if(/\s/g.test(t))return t;var r=v(t),n=r?t.substr(0,t.length-r.length):t;return e?n+e:n}function I(t,e){var r=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?/g,n=A(u.pth(t)?t.totalLength:t,e)+"";return{original:n,numbers:n.match(r)?n.match(r).map(Number):[0],strings:u.str(t)||e?n.split(r):[]}}function E(t){var e=function(t){return c(t?f(u.arr(t)?t.map(l):l(t)):[],(function(t,e,r){return r.indexOf(t)===e}))}(t);return e.map((function(t,r){return{target:t,id:r,total:e.length,transforms:{list:C(t)}}}))}function O(t,e){var r=h(e);if(u.arr(t)){var n=t.length;2===n&&!u.obj(t[0])?t={value:t}:u.fnc(e.duration)||(r.duration=e.duration/n)}return(u.arr(t)?t:[t]).map((function(t,e){return u.obj(t)&&!u.pth(t)?t:{value:t}})).map((function(t){return g(t,r)}))}function T(t,e){var r;return t.tweens.map((function(n){var a=function(t,e){var r={};for(var n in t){var a=y(t[n],e);u.arr(a)&&1===(a=a.map((function(t){return y(t,e)}))).length&&(a=a[0]),r[n]=a}return r.duration=parseFloat(r.duration),r}(n,e),o=a.value,i=u.arr(o)?o[1]:o,s=v(i),c=M(e.target,t.name,s,e),f=r?r.to.original:c,l=u.arr(o)?o[0]:f,d=v(l)||v(c),h=s||d;return u.und(i)&&(i=f),a.from=I(l,h),a.to=I(S(i,l),h),a.start=r?r.end:0,a.end=a.start+a.duration,a.isPath=!1,a.isColor=u.col(a.from.original),a.isColor&&(a.round=1),r=a,a}))}var L={css:function(t,e,r){return t.style[e]=r},attribute:function(t,e,r){return t.setAttribute(e,r)},object:function(t,e,r){return t[e]=r},transform:function(t,e,r,n,a){if(n.list.set(e,r),e===n.last||a){var o="";n.list.forEach((function(t,e){o+=e+"("+t+") "})),t.style.transform=o}}};function j(t,e){E(t).forEach((function(t){for(var r in e){var n=y(e[r],t),a=t.target,o=v(n),i=M(a,r,o,t),u=S(A(n,o||v(i)),i),s=P(a,r);L[s](a,r,u,t.transforms,!0)}}))}function V(t,e){return c(f(t.map((function(t){return e.map((function(e){return function(t,e){var r=P(t.target,e.name);if(r){var n=T(e,t),a=n[n.length-1];return{type:r,property:e.name,animatable:t,tweens:n,duration:a.end}}}(t,e)}))}))),(function(t){return!u.und(t)}))}var N=0;function F(t){var n=p(e,t),a=p(r,t),o=function(t,e){var r=[];for(var n in e)u.key(n)&&r.push({name:n,tweens:O(e[n],t)});return r}(a,t),i=E(t.targets),s=V(i,o),c=function(t,e){var r=t.length,n={};return n.duration=r?Math.max.apply(Math,t.map((function(t){return t.duration}))):e.duration,n}(s,a),f=N;return N++,g(n,{id:f,children:[],animatables:i,animations:s,duration:c.duration})}function $(t){void 0===t&&(t={});var e,r=0,n=null;function a(t){var e=window.Promise&&new Promise((function(t){return n=t}));return t.finished=e,e}var i=F(t);function u(t,e){e&&e.seek(t)}function s(t){var s=i.duration,f=t;i.progress=o(f/s*100,0,100),i.reversePlayback=f<i.currentTime,e&&function(t){if(i.reversePlayback)for(var n=r;n--;)u(t,e[n]);else for(var a=0;a<r;a++)u(t,e[a])}(f),!i.began&&i.currentTime>0&&(i.began=!0),function(t){for(var e=0,r=i.animations,n=r.length;e<n;){var a=r[e],u=a.animatable,s=a.tweens,f=s.length-1,l=s[f];f&&(l=c(s,(function(e){return t<e.end}))[0]||l);for(var d=o(t-l.start,0,l.duration)/l.duration,h=l.to.strings,p=l.round,g=[],m=l.to.numbers.length,v=void 0,y=0;y<m;y++){var x=void 0,b=l.to.numbers[y],w=l.from.numbers[y]||0;x=w+d*(b-w),p&&(l.isColor&&y>2||(x=Math.round(x*p)/p)),g.push(x)}var P=h.length;if(P){v=h[0];for(var C=0;C<P;C++){h[C];var k=h[C+1],M=g[C];isNaN(M)||(v+=k?M+k:M+" ")}}else v=g[0];L[a.type](u.target,a.property,v,u.transforms),a.currentValue=v,e++}}(f),i.currentTime=o(f,0,s),t>=s&&(i.paused=!0,i.completed||(i.completed=!0,!i.passThrough&&"Promise"in window&&(n(),a(i))))}return a(i),i.reset=function(){i.passThrough=!1,i.currentTime=0,i.progress=0,i.paused=!0,i.began=!1,i.completed=!1,i.reversePlayback=!1,e=i.children;for(var t=r=e.length;t--;)i.children[t].reset()},i.set=function(t,e){return j(t,e),i},i.seek=function(t){s(t)},i.reset(),i}function G(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function X(t){for(var e,r=t.points,n=0,a=0;a<r.numberOfItems;a++){var o=r.getItem(a);a>0&&(n+=G(e,o)),e=o}return n}function Y(t){if(t.getTotalLength)return t.getTotalLength();switch(t.tagName.toLowerCase()){case"circle":return function(t){return 2*Math.PI*x(t,"r")}(t);case"rect":return function(t){return 2*x(t,"width")+2*x(t,"height")}(t);case"line":return function(t){return G({x:x(t,"x1"),y:x(t,"y1")},{x:x(t,"x2"),y:x(t,"y2")})}(t);case"polyline":return X(t);case"polygon":return function(t){var e=t.points;return X(t)+G(e.getItem(e.numberOfItems-1),e.getItem(0))}(t)}}function B(t,e){var r=e||{},n=r.el||function(t){for(var e=t.parentNode;u.svg(e)&&u.svg(e.parentNode);)e=e.parentNode;return e}(t),a=n.getBoundingClientRect(),o=x(n,"viewBox"),i=a.width,s=a.height,c=r.viewBox||(o?o.split(" "):[0,0,i,s]);return{el:n,viewBox:c,x:c[0]/1,y:c[1]/1,w:i,h:s,vW:c[2],vH:c[3]}}$.version="3.1.0",$.get=M,$.set=j,$.convertPx=b,$.penner=s,$.path=function(t){return{el:t,svg:B(t),totalLength:Y(t),deltaCorrections:{x:4,y:5}}},$.getPathProgress=function(t,e,r){function n(r){void 0===r&&(r=0);var n=e*t.totalLength,a=n+r>=1?n+r:0;return t.el.getPointAtLength(a)}var a=B(t.el,t.svg),o=n(),i=n(-1),u=n(1);return{x:1*(o.x-a.x),y:1*(o.y-a.y),angle:180*Math.atan2(u.y-i.y,u.x-i.x)/Math.PI}};var Z=$;class q extends t.ExtendableCSSEffect{onGetContext(){const t={};if(Object.prototype.hasOwnProperty.call(this.compoAttributes,this.attributeKey)){const e=this.compoAttributes[this.attributeKey];for(let r=0;r<e.length;r++)Object.prototype.hasOwnProperty.call(this.targetValue,e[r])&&(t[e[r]]=[this.initialValue[e[r]],this.targetValue[e[r]]])}else t[this.attributeKey]=[this.initialValue,this.targetValue];this.target=Z({autoplay:!1,duration:this.props.duration,easing:"linear",targets:this.element,...(this.attrs||{}).attrs||{},...t})}onProgress(t){return this.target.seek(this.target.duration*this.getFraction(t))}}class H extends t.Effect{onGetContext(){this.pixelsAccuracy=this.attrs.pixelsAccuracy||4,this.calculatedPoints=[];const t=this.context.getElements(this.targetValue.pathElement)[0];this.path=Z.path(t),this.isPathTargetInsideSVG=this.element instanceof SVGElement}onProgress(t){let e;const r=Math.round(this.path.totalLength/this.pixelsAccuracy*this.getFraction(t))*this.pixelsAccuracy;if(null!=this.calculatedPoints[r])e=this.calculatedPoints[r];else{const t=Z.getPathProgress(this.path,r/this.path.totalLength,this.isPathTargetInsideSVG);e="\n            translateX(".concat(t.x,"px)\n            translateY(").concat(t.y,"px)\n            rotate(").concat(t.angle,"deg)\n        "),this.calculatedPoints[r]=e}this.element.style.transform=e}}return{npm_name:"@donkeyclip/motorcortex-anime",version:"3.1.1",CSSEffect:q,incidents:[{exportable:H,name:"MotionPath",attributesValidationRules:{animatedAttrs:{type:"object",props:{positionOn:{type:"object",props:{pathElement:{type:"string"}}}}}}}]}}));
